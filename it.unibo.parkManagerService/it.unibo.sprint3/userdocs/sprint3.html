<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<style type="text/css">
body
{
    margin-left:  30px;
    margin-right: 30px;
};

P
{
    font-family: Tahoma;
    font-size: 10pt;
};

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
	font-size: 93%;
}

a:hover {
    background-color: #cccccc;
}


hr {
    clear: both;
    height: 1px;
    color: #242424;
    background-color: transparent;
}

h1, h2, h3 {
    color: #242424;
    clear: left;
    font: 100% Tahoma, Helvetica, Arial, sans-serif;
    margin-bottom: 0.5em;
    padding-top: 0.5em;
	border-radius: 10px;
	padding: 5px;
}

top {
	width: 100%;
}


#i {
    color: #ff1010;
}
tt{
	font-family: "Arial";
    font-size: 90%;
	color: #006600;
}
em{
	font-family: "Arial";
    font-size: 80%;
	font-weight: bold;
	border-style:solid;
	border-color: #abe876;
    color: #1632cc;
}
bc{
	font-family: "Arial";
	font-size: 90%;
	font-weight: bold;
    color: #990000;
	background-color: #fcf8c7;
}
ks{
	font-family: "Arial";
	font-weight: bold;
    color: #0000CD	;
	font-size: 90%;
}
kc{
	font-family: "Arial";
	font-weight: bold;
    color: #008000	;
	font-size: 90%;
}
pre{
	font-family: "Consolas";
	font-size: 85%;
	background-color: #f5f5f5;
	border: 1.5px solid silver;
	padding: 5px;
}
m{
	font-family: "Helvetica";
	line-height: 100%;
 	font-size: 75%;
}
div.body{
	 
    font-size: 18px;
}
k{
	font-family: "Arial";
    color: #990000;
	font-weight: bold;
	font-size: 90%;
}
kn{
	font-family: "Arial";
    color: #0000CD	;
	font-size: 90%;
}
h1 {
    font-size: 150%;
    background-color: #b2c0ff;
	padding: 10px;
}

h2 {
    background-color: #9ed8ff;
    font-size: 130%;
}

h3 {
	background-color: #e6ccff;
    font-size: 100%;
}
h4 {
    background-color: #ccffcc;
    font-size: 100%;
	width: 95%;
	border-radius: 5px;
	padding: 2px;
}
h5 {
    background-color: #d5ffb0;
    font-size: 100%;

}
div.req{
	background-color: #d9ffb3;
    font-size: 18px;
	width: 700px;
    border: 3px solid green;
    padding: 15px;
    margin: 10px;
}
div.remark{
	background-color: #E3F2FD;
    border: 1.5px solid #d5f2ed;
    padding: 15px;
    margin: 10px;
	border-radius: 25px;
}
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}

ol, ul, li {
  margin: 0;
  margin-left: 10px;
  padding: 0;
  padding-bottom: 5px;
}

table, th, td {
	border: 1px solid black;
}

img {
	border: 1.5px solid #d5f2ed

}

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
}

div.wrapdesc{
	width: 90%;
	margin: auto;
}

div.imagedesc{
	width: 85%;
	margin: auto;
}
</style>
    
<head>
   
<title>Sprint 3</title></head>
    
<body>
<div id="top">
<h1>Workplan Automated Car-Parking- Sprint 3: <font size="5"></font> </h1>
</div>  

<h2>Requirements</h2>

<div class="remark">
The requirements given by the costumers  <a href="https://github.com/anatali/issLab2021/blob/main/it.unibo.issLabStart/userDocs/TFBO21ISS.pdf" target="web">Automated Car-Parking</a> considered in the following SPRINT are:</li>
</div> 
<li>an <em>INDOOR</em> to enter the car in the area. Facing the <tt>INDOOR</tt>, there is
	a <em>INDOOR-area</em> equipped with a <em>weigthsensor</em> that measures the <em>weigth</em> of the car;</li>

	<li>an <em>OUTDOOR</em> to exit from the <tt>parking-area</tt>. Just after the <tt>OUTDOOR</tt>, there is
	<em>OUTDOOR-area</em> equipped with a <em>outsonar</em>, used to detect the presence of a car.
	



<li>I expect that the <tt>ParkManagerService</tt> sends to me an <em>alarm</em> if it detectes that the <tt>OUTDOOR-area</tt>
has not been cleaned within the <tt>DTFREE</tt> interval of time.</li>
</ul>


<h3>User stories</h3>
 
<li>
<em>acceptIN</em>: accept the request of a client to park the car if there is at least one <tt>parking-slot</tt> available,
select a free slot identified with a unique <tt>SLOTNUM</tt>.<br/>
A request of this type can be elaborated only when the <k><tt>INDOOR-area</tt> is free</k>, 
If the <tt>INDOOR-area</tt> is already engaged by a car, the request is not immediately processed 
(the client could simply wait or could - optionally - receive a proper notice). 
<br/>
  


<li>
<em>acceptOUT</em>: accept the request of a client to get out the car with <tt>TOKENID</tt>.
A request of this type can be elaborated only when the <k><tt>OUTDOOR-area</tt> is free</k> 
and  the <tt>transport trolley</tt> is at <tt>home</tt> or working (<k>not stopped</k> by the manager).
If the <tt>OUTDOOR-area</tt> is still engaged by a car, the request is not immediately processed 
(the client could simply wait or could - optionally - receive a proper notice).
<h4>About the devices</h4>
All the sensors (<tt>weigthsensor</tt>, <tt>outsonar</tt>, <tt>thermometer</tt> ) and the <tt>fan</tt> should be properly simulated
by mock-objects or mock-actors.
<br><br>
The following sprint will focus to <kn>realize interection between the parkManagerService and the sensors</kn>.

<h2>Requirement analysis</h2>

	Our interaction with the customer has made it clear what he means for:																<li><kn>INDOOR-area</kn>: the area in front of the parking INDOOR where is the weightsensor and the trasport trolley loads the car;</li>
<li><kn>OUTDOOR-area</kn>: the area in front of the parking OUTDOOR where is the OUTsonar and the trasport trolley releases the car;</li> 
<li><kn>weightsensor</kn>: an simulate device capable of detecting the presence of a car and measuring its weight. It is in the INDOOR-area and sends the information taken via the network as event emitter;</li>
<li><kn>outsonar</kn>: an simulate or (optionally) a real device capable of detecting the presence of a car. It is in the OUTDOOR-area and sends the information taken via the network as event emitter. In the case it is a real device the costumer gives us the seguent software: <a href="https://raw.githubusercontent.com/anatali/issLab2021/main/it.unibo.rasp2021/resources/rasp/sonar/SonarAlone.c" target="web"> SonarAlone.c</a>;</li>

<li><kn>alarm</kn>: a message that has been sent by the ParkManagerService to the ParkServiceStatusGUI if the OUTDOOR-area has not been vacated within an interval of time DTFREE;</li>
	<div class="remark"> To destroy the abstraction gap is possible to use QACTOR which is a modelling language and defines a work model of the system based on actors behavior.
	</div>

<h2> Problem analysis</h2>

	The list of requirements for this sprint is:
	<ul>
		<li>the <tt>OUTsonar</tt> detects the presence of a car in the OUTDOOR-area(3); </li>
		<li>the <tt>weigthsensor</tt> detects and measures the weight of the car in the INDOOR-area(3); </li>
	</ul>
	To handle the information sent by the OUTsonar, the application must be able to:
		<ul>
			<li>communicate with the <tt>l'OUTSonar;</tt></li>
			<li>manage the information received from <tt>OUTSonar</tt> relating to the status of the <tt>OUTDOOR-area</tt>;</li>
			<li>send an alarm after a DTFREE time if the <tt>OUTDOOR-area</tt> is not yet vacated.</li>
		</ul>
	To handle the information sent by the <tt>weightsensor</tt>, the application must be able to:
		<ul>
			<li>communicate with the <tt>weightsensor</tt>;</li>
			<li>manage the information received from <tt>weightsensor</tt> relating to the status of the <tt>OUTDOOR-area</tt>.</li>
		</ul>

	<h3>Components</h3>

		<h4>Weightsensor</h4>
			
			<table>
					<tbody>
						<tr>
							<td>
										
							The Weightsensor is modelled as a mock QActor and it is an events emitter which are sent when the INDOORAREA is vacated. It should be able to send the information about the weight too. <br>
							To simulate this behavior the parkservicegui informs it that the client enters the car in the INDOORAREA thus it could start to send events until the transport-trolley takes the car and frees up the INDOORAREA. 
		
							</td>
							<td style="width: 55%">
					
					 <center><img src="./img/weightsensorState.png" alt="weightsensorState" width="100%" ></center> 
							</td>
						</tr>
					</tbody>
				</table> 

		<h4>Outsonar</h4>
			</kn> <br>
		
			<table>
					<tbody>
						<tr>
							<td>
								The Outsonar is modelled as a mock QActor and it is an events emitter when the OUTDOORAREA is vacated.<br> 
								To simulate this behavior the transporttrolley inform it that there is a car in the OUTDOORAREA thus it could start to send events until the client takes the car and frees up the OUTDOORAREA. 
		
	
							</td>
							<td style="width: 55%">
					
					 <center><img src="./img/outsonarState.png" alt="outsonarState" width="70%" ></center> 
							</td>
						</tr>
					</tbody>
				</table> 
		
		<h4>Outmanager</h4><table>
					<tbody>
						<tr>
							<td>
							The Outmanager was modelled as QActor and its aim is to send an alarm (event) when the OUTDOORAREA is still vacated over a DTFREE time. 
							It is a part of ParkManagerService and it is specialized to manage the outsonar informations. 
							The reason why it is necessary modelled this actor is the implementation of timer and, thus, guarantee the fulfillment of other actions by other components while the timer is going.  
	
							</td>
							<td style="width: 55%">
					
					 <center><img src="./img/outmanagerState.png" alt="outmanagerState" width="70%" ></center> 
							</td>
						</tr>
					</tbody>
				</table> 
			
	<h4>The ParkManagerService</h4>
	The ParkManagerService was modelled as in the <a href="https://htmlpreview.github.io/?https://github.com/noemival/ParkManagerService_2021/blob/main/it.unibo.parkManagerService/it.unibo.sprint2/userdocs/sprint2.html"target="web">sprint2.html</a>, except for handleling messages which are sent by the weightsensor.
	

	<h3>Components comunication</h3>
	<table style="width:98%">	
		<td style="width:50%" >
				<center><img src="./img/comunication_sprint3.png" alt="comunication" width="50%" ></center> 
		</td>
	</table>
	<br></br>

		<table style="width:98%">	
				<tr>
						<k>Weightsensor </k>
						
					<td style="width:50%" >
						
						<br> The weightsensor as an events emitter
					</td>
					<td>
						<pre>
Event weightsensor : weightsensor (W)

Context ctxparkingarea ip [host="localhost" port=8021]

QActor weightsensor context ctxparkingarea{
	...
		emit weightsensor : weightsensor ($WEIGHT)
	...

}
					    </pre>
					</td>
					</tr>
				</tbody>
			</table>
			<br>		<table style="width:98%">	
				<tr>
						<k>Outsonar </k>
						
					<td style="width:50%" >
						
						<br> The weightsensor as an events emitter
					</td>
					<td>
						<pre>
Event outsonar : outsonar (O)

Context ctxparkingarea ip [host="localhost" port=8021]

QActor outsonar context ctxparkingarea{
	...
		emit outsonar : outsonar(O)
	...

}
					    </pre>
					</td>
					</tr>
				</tbody>
			</table>
			<br>			
			
		<table style="width:98%">	
				<tr>
						<k>Outmanager/ParkManagerService </k>
					
					<td style="width:50%" >
						
						<br> The Outmanager will send dispatches to the
						ParkManagerService to inform it if the OUTDOORAREA is vacated or not. When it is over the DTFREE the OutManager will send to the ParkManagerService an alarm which is an event.   
					</td>
					<td>
						<pre>
Dispatch outfree : outfree(free)

Context ctxparkingarea ip [host="localhost" port=8021]

QActor outmanager context ctxparkingarea{
...
	State work{
	...
	forward parkmanagerservice -m outfree : outfree (occ)
	...		
	} 	
	}
	State free {
		forward parkmanagerservice -m outfree : outfree (free)
	}
}
	

					    </pre>
					</td>
					</tr>
				</tbody>
			</table>
			<br>				
			<table>
				

<br>
<div class="remark">
The first excecutable model is the following file: <a href="https://raw.githubusercontent.com/noemival/ParkManagerService_2021/main/it.unibo.parkManagerService/it.unibo.sprint3/src/sprint3.qak"target="web">sprint3.qak</a>						
</div>	


<h2>Testplan</h2>

	<k>Testplan </k>: we should simulate and check if the parkManagerService recive the alarm from the outmanager when the OUTDOORAREA is still vacated over a DTFREE time.
<br><br> The code is the following file:  <a href="https://raw.githubusercontent.com/noemival/ParkManagerService_2021/main/it.unibo.parkManagerService/it.unibo.sprint3/test/it/unibo/sprint_3/TestPlan.kt"target="web">TestPlan.kt</a></p>
	<br>
	To realize an authomatized test we will use JUNIT.
	
		
<h2>Deployment</h2>
	
The project is located in the repository: <a href="https://github.com/noemival/ParkManagerService_2021/tree/main/it.unibo.parkManagerService"target="web">https://github.com/noemival/ParkManagerService_2021/tree/main/it.unibo.parkManagerService</a></p>
 
<!-- USEFUL
<table style="width:100%" border="1">
<tr>
<td style="width:50%">
</td>
<td></td>
</tr>
</table>
-->
	      	
<br/><br/> 	
</div>  

<div style="background-color:rgba(86, 56, 253, 0.9); width:60%;text-align:left;color:white">
By studentName email: antonio.iacobelli@studio.unibo.it  
<img src="./img/antonioIacobelli.jpg" alt="mbot" width="15%" height="15%">
</div> 
<br>
<div style="background-color:rgba(86, 56, 253, 0.9); width:60%;text-align:left;color:white">
By studentName email: noemi.valentini5@studio.unibo.it  
<img src="./img/noemiValentini.jpg" alt="mbot" width="15%" height="15%">
</div> 
</body>
</html>