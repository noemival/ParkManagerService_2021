<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<style type="text/css">
body
{
    margin-left:  30px;
    margin-right: 30px;
};

P
{
    font-family: Tahoma;
    font-size: 10pt;
};

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
	font-size: 93%;
}

a:hover {
    background-color: #cccccc;
}


hr {
    clear: both;
    height: 1px;
    color: #242424;
    background-color: transparent;
}

h1, h2, h3 {
    color: #242424;
    clear: left;
    font: 100% Tahoma, Helvetica, Arial, sans-serif;
    margin-bottom: 0.5em;
    padding-top: 0.5em;
	border-radius: 10px;
	padding: 5px;
}

top {
	width: 100%;
}


#i {
    color: #ff1010;
}
tt{
	font-family: "Arial";
    font-size: 90%;
	color: #006600;
}
em{
	font-family: "Arial";
    font-size: 80%;
	font-weight: bold;
	border-style:solid;
	border-color: #abe876;
    color: #1632cc;
}
bc{
	font-family: "Arial";
	font-size: 90%;
	font-weight: bold;
    color: #990000;
	background-color: #fcf8c7;
}
ks{
	font-family: "Arial";
	font-weight: bold;
    color: #0000CD	;
	font-size: 90%;
}
kc{
	font-family: "Arial";
	font-weight: bold;
    color: #008000	;
	font-size: 90%;
}
pre{
	font-family: "Consolas";
	font-size: 85%;
	background-color: #f5f5f5;
	border: 1.5px solid silver;
	padding: 5px;
}
m{
	font-family: "Helvetica";
	line-height: 100%;
 	font-size: 75%;
}
div.body{
	 
    font-size: 18px;
}
k{
	font-family: "Arial";
    color: #990000;
	font-weight: bold;
	font-size: 90%;
}
kn{
	font-family: "Arial";
    color: #0000CD	;
	font-size: 90%;
}
h1 {
    font-size: 150%;
    background-color: #b2c0ff;
	padding: 10px;
}

h2 {
    background-color: #9ed8ff;
    font-size: 130%;
}

h3 {
	background-color: #e6ccff;
    font-size: 100%;
}
h4 {
    background-color: #ccffcc;
    font-size: 100%;
	width: 95%;
	border-radius: 5px;
	padding: 2px;
}
h5 {
    background-color: #d5ffb0;
    font-size: 100%;

}
div.req{
	background-color: #d9ffb3;
    font-size: 18px;
	width: 700px;
    border: 3px solid green;
    padding: 15px;
    margin: 10px;
}
div.remark{
	background-color: #E3F2FD;
    border: 1.5px solid #d5f2ed;
    padding: 15px;
    margin: 10px;
	border-radius: 25px;
}
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}

ol, ul, li {
  margin: 0;
  margin-left: 10px;
  padding: 0;
  padding-bottom: 5px;
}

table, th, td {
	border: 1px solid black;
}

img {
	border: 1.5px solid #d5f2ed

}

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
}

div.wrapdesc{
	width: 90%;
	margin: auto;
}

div.imagedesc{
	width: 85%;
	margin: auto;
}
</style>
    
<head>
   
<title>Sprint 5</title></head>
    
<body>
<div id="top">
<h1>Workplan Automated Car-Parking- Sprint 5 <font size="5"></font> </h1>
</div>  

<h2>Requirements</h2>

<div class="remark">
The requirements given by the costumers  <a href="https://github.com/anatali/issLab2021/blob/main/it.unibo.issLabStart/userDocs/TFBO21ISS.pdf" target="web">Automated Car-Parking</a> considered in the following SPRINT are:</li>
</div>

	<ul>
		<li>a <em>parking-manager</em> (an human being) which supervises the state of the <tt>parking-area</tt> 
	</ul>
<h3>User stories</h3>
As a <bc>parking-manager</bc>:
<ul>
<li>I intend to use the <em>ParkServiceStatusGUI</em>  provided by the <tt>ParkManagerService</tt>
to observe the <em>current state</em> of the <tt>parking area</tt>, including the value <tt>TA</tt> of the temperature,
the state of the <tt>fan</tt> and the state of the <tt>transport trolley</tt> (<k>idle, working or stopped</k>).</li>
<li>I intend to <em>stop</em> the <tt>transport trolley</tt> when <k>TA > TMAX</k>, activate the <tt>fan</tt> and 
wait until <k>TA &lt; TMAX</k>. At this time, I stop the <tt>fan</tt> and resume the behavior of the <tt>transport trolley</tt>.
Hopefully, the <b>start/stop</b> <ks>of the fan</ks> could also be automated by the <tt>ParkManagerService</tt>,
while the <b>start/stop</b> <ks>of the transport trolley</ks> is always up to me.
</li>
<li>I expect that the <tt>ParkManagerService</tt> sends to me an <em>alarm</em> if it detectes that the <tt>OUTDOOR-area</tt>
has not been cleaned within the <tt>DTFREE</tt> interval of time.</li>
</ul>
The <tt>ParkManagerService</tt> should create the <tt>ParkServiceStatusGUI</tt> (for the manager) and then perform the following tasks:
<li>
<em>monitor</em>: update the <tt>ParkServiceStatusGUI</tt> with the required information about the state of the system.
</li>

<li>
<em>manage</em>: accept the request of the manager to stop/resume the behavior of the  <tt>transport trolley</tt>.
</li>

   <h4>When using <k>only</k> the virtual robot or <k>no real sonar</k> available</h4>
Consider the new requirement:
<ul>
<li><ks>authorize</ks>: allow a manager to use the <tt>ParkServiceStatusGUI</tt> only if she/he owns <bc>proper permissions</bc>.</li>
 
</ul>
The following sprint will focus to <kn>realize the operations of the parkingManager </kn>.
<h2>Requirement analysis</h2>

Our interaction with the customer has made it clear what he means for:
<li><kn>ParkServiceStatusGUI</kn>: an user interface that allows a parking-manager to comunicate with parkManagerService using graphic representations and that shows the parking-area current state; </li>
<li><kn>current state</kn>: TA temperature, state of the fan (on/off), state of the trasport trolley (idle, working or stopped);
<li><kn>stop</kn>: when the robot isn't in a idle or working state;
<li><kn>alarm</kn>: a message that has been sent by the ParkManagerService to the ParkServiceStatusGUI if the OUTDOOR-area has not been vacated within an interval of time DTFREE;</li>

<h2>Problem analysis</h2>
<div>
	The list of requirements for this sprint is:
	<ul>
		<li>the <tt>transport-trolley</tt> will be stopped by the parking-manager if the thermometer mesures a temperature higher than TMAX (4);</li>
		<li>the <tt>transport-trolley</tt> will be resume by the parking-manager if the thermometer mesures a temperature lower than TMAX and if the robot was stopped (4);</li>
		<li>the <tt>parking-manager</tt> turns off the fan if the parking area temperature is lower than TMAX (5);</li>
		<li>the <tt>parking-manager</tt> turns on the fan if the parking area temperature is higher than TMAX (5);</li>
		<li>the <tt>ParkManagerService</tt> sends an alarm to the ParkServiceStatusGUI if the OUTSonar detects that the OUTDOOR-area has not been vacated within the DTFREE time interval (5);</li>
		<li>the <tt>parking-manager</tt> views the parking-area current status using the ParkServiceStatusGUI (5);</li>
		<li>the <tt>parking-manager</tt> must authenticate himself to access the ParkServiceStatusGUI (6).</li>

	</ul>
	To carry out the operations requested by the <tt>parking-manager</tt> (manage, monitor), the application must be able to:	
		<li>retrieve all the information needed by the <tt>parking-manager</tt>;</li>
		<li>communicate with the <tt>parking-manager</tt>;</li>
		<li>forward the stop / resume commands received from <tt>parking-manager</tt> to the <tt>transport-trolley</tt>;</li>
		<li>forward the stop / start commands received from al <tt>parking-manager</tt> to the <tt>fan</tt>;</li>
		<li>realize the <tt>ParkServiceStatusGUI</tt>;</li>
		<li>update the <tt>ParkServiceStatusGUI</tt> with information regarding the system status: <tt>TA</tt>, state <tt>fan</tt>, state <tt>transport-trolley</tt>;</li>
		<li>authorize the <tt>parking-manager</tt> to use <tt>ParkServiceStatusGUI</tt> only after he was being authenticated.</li>
</div>
	<div class="remark"> To destroy the abstraction gap is possible to use QACTOR which is a modelling language and defines a work model of the system based on actors behavior.
	</div>
	<h3>Components</h3>
	<h4>ParkingManager</h4>
			<br>
		
			<table>
					<tbody>
						<tr>
							<td>
								<li>The ParkingManager is an application server that interacts via network with the the thermometer, fan, trolley and the ParkServiceStatusGui. 
								It is a part of ParkManagerService and it is specialized to manage the parkingmanager behavior. 
								In our analysis the existence of the ParkingManager is related to the requirement to stop the transport-trolley which cannot be done by ParkManagerService present in the directory <a href="https://htmlpreview.github.io/?https://github.com/noemival/ParkManagerService_2021/blob/main/it.unibo.parkManagerService/it.unibo.sprint3/userdocs/sprint3.html"target="web">sprint3.html</a></li>
								<li>The ParkingManager should recive the information of the transport-trolley and the fan so its is like an observer too. It will use a support <a href="https://raw.githubusercontent.com/noemival/ParkManagerService_2021/main/it.unibo.parkManagerService/it.unibo.sprint5/src/utility/HandleData.kt"target="web">HandleData.kt</a> (based on <a href="https://raw.githubusercontent.com/noemival/ParkManagerService_2021/main/it.unibo.parkManagerService/it.unibo.sprint5/src/utility/CoapSupport.kt"target="web">CoapSupport.kt</a>) to implements this behavior. 
								</li>
							</td>
							<td style="width: 55%">
								<center><img src="./img/pmstate.png" alt="ParkingManagerState" width="400" ></center> 
							</td>
						</tr>
					
					</tbody>
			</table> 

		<h4>ParkServiceStatusGui</h4>
			<table>
					<tbody>
						<tr>
							<td>
							The ParkServiceStatusGui interface allows the customer to communicate with our system. Because it is preferable that the grafic interfaces will be portable, that are indipendent from hardware components and from the operative system of the user device, the choise will be to realize the
								Web-application in the following way:
								<ul>
									<li>they could be two HTML pages both with INPUT sections (e.g. stop/resume the trolley) and OUTPUT sections (e.g. temperature).</li>
								</ul>

								The ParkServiceStatusGUI should monitor the the system current state. It should ask to the application the information needed. The implementation could be done with a polling mechanism, that is a request/response interaction, but this is only one possible solution. Another one could be a dispatch interaction, or using an observer.
								<br><br>
								The techology should be SpringBoot to reduce development time.
								Right now we just confine its behavior to a mock-qactor. Its complete realization will be done in the project phase (e.g. authentication phase) .


					</td>
							</td>
							<td style="width: 55%">
					
								<center><img src="./img/psgstate.png" alt="ParkServiceStatusGUIState" width="400" ></center> 
							</td>
						</tr>
					</tbody>
				</table> 
		<br>
			Others components was modelled in lasts sprints.
		
	<h3>Components comunication</h3>
	<table style="width:98%">	
		<td style="width:50%" >
				<center><img src="./img/architettura_logica.png" alt="architettura_logica_iniziale" width="60%" ></center> 
		</td>
	</table>
	
	<br><br>

		<table style="width:100%">
			<tbody>	
				<tr>
						<k>ParkingManager/TransportTrolley</k>
						
					<td style="width:50%" >
						
						<br> The ParkingManager will send the command to the transport-trolley in a asynchronous way to reduce the quantity of messeges, to avoid of messages and to avoid stopping the application waiting for a response.
					</td>
					<td>
						<pre>
Dispatch trolleystop :  trolleystop(V)
Dispatch trolleyresume :  trolleyresume(V)

Context ctxparkingarea ip [host="localhost" port=8021]

QActor parkingmanager context ctxparkingarea{ 
	...
	forward transporttrolley -m trolleystop : trolleystop(w)  	
	...
	forward transporttrolley -m trolleyresume : trolleyresume(w)  	

}


					    </pre>
					</td>
					</tr>
				</tbody>
			</table>
<br>
		<table >
			<tbody>	
				<tr>
						<k>ParkServiceStatusGui</k>
						
					<td style="width:50%" >
						<br> 
The interaction follow is modelled with events because the ParkServiceStatusGui operations will processing like a botton which in an distribuited system are like an observable. 
					</td>
					<td>
						<pre>
Event stateChangetrolley :  stateChangetrolley (V)
Event stateChangefan :  stateChangefan (V)
						
Context ctxparkingarea ip [host="localhost" port=8021]

QActor parkservicestatusgui context ctxparkingarea {
	...
		emit stateChangetrolley : stateChangetrolley(stop)
		emit stateChangefan : stateChangefan(work)
	...
		emit stateChangetrolley : stateChangetrolley(work)	
		emit stateChangefan : stateChangefan(stop)

}
					    </pre>
					</td>
					</tr>
				</tbody>
			</table>
<br>
		<table >
			<tbody>	
				<tr>
						<k>ParkingManager</k>
						
					<td style="width:50%" >
						<br> 
The interaction follow is modelled with events because the recipient is uknown in the requirements and other components could be intrested of what is happening in future.
					</td>
					<td>
						<pre>
Event warning :  warning(V)
Event alarm :  alarm(V)
					
Context ctxparkingarea ip [host="localhost" port=8021]

QActor parkingmanager context ctxparkingarea {
	...
		emit warning : warning(V)
		emit alarm : alarm(V)


}
					    </pre>
					</td>
					</tr>
				</tbody>
			</table>
<br>
<div >
The other interactions was modelled in last sprints.					
</div>
				

<br>
<div class="remark">
The executable model is present in the following file: <a href="https://raw.githubusercontent.com/noemival/ParkManagerService_2021/main/it.unibo.parkManagerService/it.unibo.sprint5/src/sprint5.qak"target="web">sprint5.qak</a></p>						
</div>	

<h3>SPRINT REVIEW</h3>
	
	The analysis was produced some aspects that will be considerend in the next SPRINT: 
	<li> all system should be interact with other components (e.g. ParkManagerService).</li>

	
<h2>Testplan</h2>

	<k>Testplan </k>: we should simulate and check if the parkingManager stop the transport-trolley<br>
 	<br> The code is present in the following file: <a href="https://raw.githubusercontent.com/noemival/ParkManagerService_2021/main/it.unibo.parkManagerService/it.unibo.sprint5/test/it/unibo/sprint5/TestPlan.kt"target="web">TestPlan.kt</a></p>

	<br>
	To realize an authomatized test we will use JUNIT.
	
<h2>Deployment</h2>
	
The project is located in the repository: <a href="https://github.com/noemival/ParkManagerService_2021/tree/main/it.unibo.parkManagerService"target="web">https://github.com/noemival/ParkManagerService_2021/tree/main/it.unibo.parkManagerService</a></p>
 
<!-- USEFUL
<table style="width:100%" border="1">
<tr>
<td style="width:50%">
</td>
<td></td>
</tr>
</table>
-->
	      	
<br/><br/> 	
</div>  

<div style="background-color:rgba(86, 56, 253, 0.9); width:60%;text-align:left;color:white">
By studentName email: antonio.iacobelli@studio.unibo.it  
<img src="./img/antonioIacobelli.jpg" alt="mbot" width="15%" height="15%">
</div> 
<br>
<div style="background-color:rgba(86, 56, 253, 0.9); width:60%;text-align:left;color:white">
By studentName email: noemi.valentini5@studio.unibo.it  
<img src="./img/noemiValentini.jpg" alt="mbot" width="15%" height="15%">
</div> 
</body>
</html>
